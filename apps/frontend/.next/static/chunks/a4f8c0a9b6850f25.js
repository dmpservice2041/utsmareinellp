(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},56909,e=>{"use strict";let t=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>t],56909)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},71689,35128,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689);var r=e.i(43476),a=e.i(71645),s=e.i(37727),l=e.i(73708),i=e.i(43531),d=e.i(55436),n=e.i(92070);function o({isOpen:e,onClose:t,onSelect:o,multiple:c=!1,selectedIds:u=[]}){let[g,m]=(0,a.useState)([]),[x,h]=(0,a.useState)(!1),[p,f]=(0,a.useState)(""),[b,y]=(0,a.useState)([]),j=(0,a.useRef)(null),N=(0,a.useRef)(""),v=(0,a.useCallback)(async(e="")=>{j.current&&j.current.abort(),j.current=new AbortController;let t=j.current.signal;h(!0);try{let r=new URL(n.API_ENDPOINTS.MEDIA);e&&r.searchParams.append("search",e);let a=await fetch(r.toString(),{credentials:"include",signal:t});if(a.ok&&!t.aborted){let e=await a.json();m(e.data||[])}}catch(e){"AbortError"!==e.name&&(console.error("Error fetching media:",e),m([]))}finally{t.aborted||h(!1)}},[]);return((0,a.useEffect)(()=>{if(!e)return;let t=JSON.stringify(u);N.current!==t&&(y(u),N.current=t)},[e,u]),(0,a.useEffect)(()=>{e?(f(""),v("")):(m([]),f(""),h(!1),y([]),N.current="",j.current&&j.current.abort())},[e,v]),(0,a.useEffect)(()=>{if(!e)return;let t=setTimeout(()=>{v(p)},300);return()=>{clearTimeout(t)}},[p,e,v]),(0,a.useEffect)(()=>()=>{j.current&&j.current.abort()},[]),e)?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:c?"Select Images":"Select Image"}),(0,r.jsx)("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,r.jsx)(s.X,{size:20})})]}),(0,r.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(d.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,r.jsx)("input",{type:"text",placeholder:"Search images...",value:p,onChange:e=>f(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]})}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:x?(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading media..."})]})}):0===g.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(l.Image,{className:"w-16 h-16 text-gray-300 mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-gray-500",children:p?"No images found":"No images uploaded yet"})]}):(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:g.map(e=>{let a=b.includes(e.id);return(0,r.jsxs)("div",{onClick:()=>{c?y(b.includes(e.id)?b.filter(t=>t!==e.id):[...b,e.id]):(o(e.id,e.urls.optimized),t())},className:`relative group cursor-pointer rounded-lg border-2 overflow-hidden transition-all ${a?"border-teal-500 ring-2 ring-teal-200":"border-gray-200 hover:border-teal-300"}`,children:[(0,r.jsxs)("div",{className:"aspect-square relative bg-gray-100",children:[(0,r.jsx)("img",{src:(0,n.getUploadUrl)(e.urls.thumbnail),alt:e.original_filename,className:"w-full h-full object-cover"}),a&&(0,r.jsx)("div",{className:"absolute inset-0 bg-teal-500 bg-opacity-20 flex items-center justify-center",children:(0,r.jsx)("div",{className:"bg-teal-500 text-white rounded-full p-2",children:(0,r.jsx)(i.Check,{size:20})})})]}),(0,r.jsx)("div",{className:"p-2 bg-white",children:(0,r.jsx)("p",{className:"text-xs text-gray-600 truncate",title:e.original_filename,children:e.original_filename})})]},e.id)})})}),(0,r.jsxs)("div",{className:"p-4 border-t border-gray-200 flex justify-between items-center",children:[c&&(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[b.length," image",1!==b.length?"s":""," selected"]}),(0,r.jsxs)("div",{className:"flex gap-2 ml-auto",children:[(0,r.jsx)("button",{onClick:t,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),c&&(0,r.jsxs)("button",{onClick:()=>{c&&b.length>0&&(b.forEach(e=>{let t=g.find(t=>t.id===e);t&&o(t.id,t.urls.optimized)}),t())},disabled:0===b.length,className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:["Select ",b.length>0&&`(${b.length})`]})]})]})]})}):null}e.s(["default",()=>o],35128)},93202,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(18566),s=e.i(71689),l=e.i(56909),i=e.i(73708),d=e.i(37727),n=e.i(22016),o=e.i(92070),c=e.i(35128);function u(){let e=(0,a.useRouter)(),u=(0,a.useParams)(),g=u?.id,[m,x]=(0,r.useState)(!1),[h,p]=(0,r.useState)(!0),[f,b]=(0,r.useState)(""),[y,j]=(0,r.useState)({title:"",short_description:"",long_description:"",category:"",status:"draft",priority:0,is_featured:!1,meta_title:"",meta_description:"",tags:"",featured_image:"",featured_image_id:null}),[N,v]=(0,r.useState)(!1);(0,r.useEffect)(()=>{g&&_()},[g]);let _=async()=>{try{let e=await fetch(o.API_ENDPOINTS.PRODUCT(g),{credentials:"include"});if(e.ok){let t=await e.json(),r=t.data||t;j({title:r.title||"",short_description:r.short_description||"",long_description:r.long_description||"",category:r.category||"",status:r.status||"draft",priority:r.priority||0,is_featured:r.is_featured||!1,meta_title:r.meta_title||"",meta_description:r.meta_description||"",tags:r.tags?.join(", ")||"",featured_image:r.featured_image||"",featured_image_id:null})}else b("Failed to load product")}catch(e){b("Connection error. Please try again.")}finally{p(!1)}},w=async t=>{t.preventDefault(),x(!0),b("");try{let t={title:y.title,short_description:y.short_description||null,long_description:y.long_description||null,category:y.category||null,featured_image:y.featured_image||null,status:y.status,priority:parseInt(String(y.priority))||0,is_featured:y.is_featured,meta_title:y.meta_title||null,meta_description:y.meta_description||null,tags:y.tags?y.tags.split(",").map(e=>e.trim()).filter(e=>e):[]},r=await fetch(o.API_ENDPOINTS.PRODUCT(g),{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await r.json();r.ok?e.push("/admin/products"):b(a.error?.message||"Failed to update product")}catch(e){b("Connection error. Please try again.")}finally{x(!1)}},k=e=>{let{name:t,value:r,type:a}=e.target;j(s=>({...s,[t]:"checkbox"===a?e.target.checked:r}))};return h?(0,t.jsx)("div",{className:"max-w-4xl",children:(0,t.jsx)("div",{className:"text-center py-12",children:(0,t.jsx)("p",{className:"text-gray-600",children:"Loading product..."})})}):(0,t.jsxs)("div",{className:"max-w-4xl",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)(n.default,{href:"/admin/products",className:"inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[(0,t.jsx)(s.ArrowLeft,{size:20}),"Back to Products"]}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Edit Product"}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:"Update product information"})]}),f&&(0,t.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 text-red-700 rounded-lg",children:f}),(0,t.jsxs)("form",{onSubmit:w,className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Basic Information"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Title *"}),(0,t.jsx)("input",{type:"text",name:"title",value:y.title,onChange:k,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"Enter product title",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Short Description"}),(0,t.jsx)("input",{type:"text",name:"short_description",value:y.short_description,onChange:k,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"Brief description"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Long Description"}),(0,t.jsx)("textarea",{name:"long_description",value:y.long_description,onChange:k,rows:5,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"Detailed description"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Featured Image"}),y.featured_image?(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("img",{src:(0,o.getUploadUrl)(y.featured_image),alt:"Featured",className:"w-full h-48 object-contain rounded-lg border border-gray-300 bg-gray-50",loading:"lazy",decoding:"async",onError:e=>{let t=e.target;if(console.error("Image failed to load:",(0,o.getUploadUrl)(y.featured_image)),t.src.includes("placeholder"))t.src="/placeholder-image.png";else{let e=o.API_ENDPOINTS.MEDIA.split("/api")[0],r=`${e}${y.featured_image}`;console.log("Trying fallback URL:",r),t.src=r}}}),(0,t.jsx)("button",{type:"button",onClick:()=>{j(e=>({...e,featured_image:"",featured_image_id:null}))},className:"absolute top-2 right-2 p-2 bg-red-600 text-white rounded-full hover:bg-red-700 shadow-lg",children:(0,t.jsx)(d.X,{size:16})}),(0,t.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Selected: ",y.featured_image]})]}):(0,t.jsxs)("button",{type:"button",onClick:()=>v(!0),className:"w-full h-48 border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center hover:border-teal-500 hover:bg-teal-50 transition-colors",children:[(0,t.jsx)(i.Image,{className:"w-12 h-12 text-gray-400 mb-2"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Click to select image from gallery"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),(0,t.jsx)("input",{type:"text",name:"category",value:y.category,onChange:k,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"e.g., Engine Parts"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),(0,t.jsx)("input",{type:"number",name:"priority",value:y.priority,onChange:k,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"0"})]})]})]})]}),(0,t.jsxs)("div",{className:"border-t pt-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"SEO Settings"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meta Title"}),(0,t.jsx)("input",{type:"text",name:"meta_title",value:y.meta_title,onChange:k,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"SEO title (auto-generated if empty)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meta Description"}),(0,t.jsx)("textarea",{name:"meta_description",value:y.meta_description,onChange:k,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"SEO description (auto-generated if empty)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags (comma-separated)"}),(0,t.jsx)("input",{type:"text",name:"tags",value:y.tags,onChange:k,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"marine, engine, parts"})]})]})]}),(0,t.jsxs)("div",{className:"border-t pt-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Publishing Options"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,t.jsxs)("select",{name:"status",value:y.status,onChange:k,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",children:[(0,t.jsx)("option",{value:"draft",children:"Draft"}),(0,t.jsx)("option",{value:"published",children:"Published"}),(0,t.jsx)("option",{value:"disabled",children:"Disabled"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"is_featured",name:"is_featured",checked:y.is_featured,onChange:k,className:"w-4 h-4 text-teal-600 border-gray-300 rounded focus:ring-teal-500"}),(0,t.jsx)("label",{htmlFor:"is_featured",className:"text-sm font-medium text-gray-700",children:"Featured Product"})]})]})]})]}),(0,t.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 rounded-b-xl flex justify-end gap-3",children:[(0,t.jsx)(n.default,{href:"/admin/products",className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,t.jsxs)("button",{type:"submit",disabled:m,className:"flex items-center gap-2 px-6 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg transition-colors disabled:bg-gray-400",children:[(0,t.jsx)(l.Save,{size:20}),m?"Updating...":"Update Product"]})]})]}),(0,t.jsx)(c.default,{isOpen:N,onClose:()=>v(!1),onSelect:(e,t)=>{j(r=>({...r,featured_image:t,featured_image_id:e})),v(!1)},multiple:!1})]})}e.s(["default",()=>u])}]);