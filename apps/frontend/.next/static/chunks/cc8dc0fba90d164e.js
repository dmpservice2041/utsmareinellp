(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,82206,e=>{"use strict";let t=(0,e.i(97001).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],82206)},46787,e=>{"use strict";let t=(0,e.i(97001).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>t],46787)},25836,e=>{"use strict";let t=(0,e.i(97001).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],25836)},92295,18991,e=>{"use strict";let t=(0,e.i(97001).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],92295);var r=e.i(39416),a=e.i(1621),s=e.i(90338),l=e.i(91691),i=e.i(25836),d=e.i(82206),n=e.i(38709);function o({isOpen:e,onClose:t,onSelect:o,multiple:c=!1,selectedIds:u=[]}){let[g,m]=(0,a.useState)([]),[x,h]=(0,a.useState)(!1),[b,p]=(0,a.useState)(""),[f,y]=(0,a.useState)([]),j=(0,a.useRef)(null),N=(0,a.useRef)(""),v=(0,a.useCallback)(async(e="")=>{j.current&&j.current.abort(),j.current=new AbortController;let t=j.current.signal;h(!0);try{let r=new URL(n.API_ENDPOINTS.MEDIA);e&&r.searchParams.append("search",e);let a=await fetch(r.toString(),{credentials:"include",signal:t});if(a.ok&&!t.aborted){let e=await a.json();m(e.data||[])}}catch(e){"AbortError"!==e.name&&(console.error("Error fetching media:",e),m([]))}finally{t.aborted||h(!1)}},[]);return((0,a.useEffect)(()=>{if(!e)return;let t=JSON.stringify(u);N.current!==t&&(y(u),N.current=t)},[e,u]),(0,a.useEffect)(()=>{e?(p(""),v("")):(m([]),p(""),h(!1),y([]),N.current="",j.current&&j.current.abort())},[e,v]),(0,a.useEffect)(()=>{if(!e)return;let t=setTimeout(()=>{v(b)},300);return()=>{clearTimeout(t)}},[b,e,v]),(0,a.useEffect)(()=>()=>{j.current&&j.current.abort()},[]),e)?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:c?"Select Images":"Select Image"}),(0,r.jsx)("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,r.jsx)(s.X,{size:20})})]}),(0,r.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(d.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,r.jsx)("input",{type:"text",placeholder:"Search images...",value:b,onChange:e=>p(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]})}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:x?(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading media..."})]})}):0===g.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(l.Image,{className:"w-16 h-16 text-gray-300 mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-gray-500",children:b?"No images found":"No images uploaded yet"})]}):(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:g.map(e=>{let a=f.includes(e.id);return(0,r.jsxs)("div",{onClick:()=>{c?y(f.includes(e.id)?f.filter(t=>t!==e.id):[...f,e.id]):(o(e.id,e.urls.optimized),t())},className:`relative group cursor-pointer rounded-lg border-2 overflow-hidden transition-all ${a?"border-teal-500 ring-2 ring-teal-200":"border-gray-200 hover:border-teal-300"}`,children:[(0,r.jsxs)("div",{className:"aspect-square relative bg-gray-100",children:[(0,r.jsx)("img",{src:(0,n.getUploadUrl)(e.urls.thumbnail),alt:e.original_filename,className:"w-full h-full object-cover"}),a&&(0,r.jsx)("div",{className:"absolute inset-0 bg-teal-500 bg-opacity-20 flex items-center justify-center",children:(0,r.jsx)("div",{className:"bg-teal-500 text-white rounded-full p-2",children:(0,r.jsx)(i.Check,{size:20})})})]}),(0,r.jsx)("div",{className:"p-2 bg-white",children:(0,r.jsx)("p",{className:"text-xs text-gray-600 truncate",title:e.original_filename,children:e.original_filename})})]},e.id)})})}),(0,r.jsxs)("div",{className:"p-4 border-t border-gray-200 flex justify-between items-center",children:[c&&(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[f.length," image",1!==f.length?"s":""," selected"]}),(0,r.jsxs)("div",{className:"flex gap-2 ml-auto",children:[(0,r.jsx)("button",{onClick:t,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),c&&(0,r.jsxs)("button",{onClick:()=>{c&&f.length>0&&(f.forEach(e=>{let t=g.find(t=>t.id===e);t&&o(t.id,t.urls.optimized)}),t())},disabled:0===f.length,className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:["Select ",f.length>0&&`(${f.length})`]})]})]})]})}):null}e.s(["default",()=>o],18991)},95397,e=>{"use strict";var t=e.i(39416),r=e.i(1621),a=e.i(31881),s=e.i(92295),l=e.i(46787),i=e.i(91691),d=e.i(90338),n=e.i(494),o=e.i(38709),c=e.i(18991);function u(){let e=(0,a.useRouter)(),[u,g]=(0,r.useState)(!1),[m,x]=(0,r.useState)(""),[h,b]=(0,r.useState)({title:"",short_description:"",long_description:"",category:"",status:"draft",priority:0,is_featured:!1,meta_title:"",meta_description:"",tags:"",featured_image:"",featured_image_id:null}),[p,f]=(0,r.useState)(!1),y=async t=>{t.preventDefault(),g(!0),x("");try{let t={title:h.title,short_description:h.short_description||null,long_description:h.long_description||null,category:h.category||null,featured_image:h.featured_image||null,status:h.status,priority:parseInt(String(h.priority))||0,is_featured:h.is_featured,meta_title:h.meta_title||null,meta_description:h.meta_description||null,tags:h.tags?h.tags.split(",").map(e=>e.trim()).filter(e=>e):[]},r=await fetch(o.API_ENDPOINTS.PRODUCTS,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await r.json();r.ok?e.push("/admin/products"):x(a.error?.message||"Failed to create product")}catch(e){x("Connection error. Please try again.")}finally{g(!1)}},j=e=>{let{name:t,value:r,type:a}=e.target;b(s=>({...s,[t]:"checkbox"===a?e.target.checked:r}))};return(0,t.jsxs)("div",{className:"max-w-4xl",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)(n.default,{href:"/admin/products",className:"inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[(0,t.jsx)(s.ArrowLeft,{size:20}),"Back to Products"]}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Add New Product"}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:"Create a new product listing"})]}),m&&(0,t.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 text-red-700 rounded-lg",children:m}),(0,t.jsxs)("form",{onSubmit:y,className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Basic Information"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Title *"}),(0,t.jsx)("input",{type:"text",name:"title",value:h.title,onChange:j,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"Enter product title",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Short Description"}),(0,t.jsx)("input",{type:"text",name:"short_description",value:h.short_description,onChange:j,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"Brief description"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Long Description"}),(0,t.jsx)("textarea",{name:"long_description",value:h.long_description,onChange:j,rows:5,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"Detailed description"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Featured Image"}),h.featured_image?(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("img",{src:(0,o.getUploadUrl)(h.featured_image),alt:"Featured",className:"w-full h-48 object-contain rounded-lg border border-gray-300 bg-gray-50",loading:"lazy",decoding:"async",onError:e=>{let t=e.target;if(console.error("Image failed to load:",(0,o.getUploadUrl)(h.featured_image)),t.src.includes("placeholder"))t.src="/placeholder-image.png";else{let e=o.API_ENDPOINTS.MEDIA.split("/api")[0],r=`${e}${h.featured_image}`;console.log("Trying fallback URL:",r),t.src=r}}}),(0,t.jsx)("button",{type:"button",onClick:()=>{b(e=>({...e,featured_image:"",featured_image_id:null}))},className:"absolute top-2 right-2 p-2 bg-red-600 text-white rounded-full hover:bg-red-700 shadow-lg",children:(0,t.jsx)(d.X,{size:16})}),(0,t.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Selected: ",h.featured_image]})]}):(0,t.jsxs)("button",{type:"button",onClick:()=>f(!0),className:"w-full h-48 border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center hover:border-teal-500 hover:bg-teal-50 transition-colors",children:[(0,t.jsx)(i.Image,{className:"w-12 h-12 text-gray-400 mb-2"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Click to select image from gallery"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),(0,t.jsx)("input",{type:"text",name:"category",value:h.category,onChange:j,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"e.g., Engine Parts"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),(0,t.jsx)("input",{type:"number",name:"priority",value:h.priority,onChange:j,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"0"})]})]})]})]}),(0,t.jsxs)("div",{className:"border-t pt-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"SEO Settings"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meta Title"}),(0,t.jsx)("input",{type:"text",name:"meta_title",value:h.meta_title,onChange:j,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"SEO title (auto-generated if empty)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meta Description"}),(0,t.jsx)("textarea",{name:"meta_description",value:h.meta_description,onChange:j,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"SEO description (auto-generated if empty)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags (comma-separated)"}),(0,t.jsx)("input",{type:"text",name:"tags",value:h.tags,onChange:j,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",placeholder:"marine, engine, parts"})]})]})]}),(0,t.jsxs)("div",{className:"border-t pt-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Publishing Options"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,t.jsxs)("select",{name:"status",value:h.status,onChange:j,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",children:[(0,t.jsx)("option",{value:"draft",children:"Draft"}),(0,t.jsx)("option",{value:"published",children:"Published"}),(0,t.jsx)("option",{value:"disabled",children:"Disabled"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"is_featured",name:"is_featured",checked:h.is_featured,onChange:j,className:"w-4 h-4 text-teal-600 border-gray-300 rounded focus:ring-teal-500"}),(0,t.jsx)("label",{htmlFor:"is_featured",className:"text-sm font-medium text-gray-700",children:"Featured Product"})]})]})]})]}),(0,t.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 rounded-b-xl flex justify-end gap-3",children:[(0,t.jsx)(n.default,{href:"/admin/products",className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,t.jsxs)("button",{type:"submit",disabled:u,className:"flex items-center gap-2 px-6 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg transition-colors disabled:bg-gray-400",children:[(0,t.jsx)(l.Save,{size:20}),u?"Saving...":"Save Product"]})]})]}),(0,t.jsx)(c.default,{isOpen:p,onClose:()=>f(!1),onSelect:(e,t)=>{b(r=>({...r,featured_image:t,featured_image_id:e})),f(!1)},multiple:!1})]})}e.s(["default",()=>u])}]);